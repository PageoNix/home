<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Login | PageoNix</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet" />
    <script src="https://accounts.google.com/gsi/client" async defer></script>

    <style>
        :root {
            --primary: #2d2d2d;
            --secondary: #555;
            --border: #e5e5e5;
            --accent: #1a1a1a;
            --hero-blue: #1e88e5;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Poppins', sans-serif;
            min-height: 100vh;
            display: flex;
            background: #f6f2bc;
        }

        /* Layout */
        .wrapper {
            display: flex;
            width: 100%;
            min-height: 100vh;
        }

        /* Hero Section */
        .hero {
            flex: 1;
            color: white;
            display: flex;
            flex-direction: column;
            justify-content: center;
            padding: 60px;
            background: linear-gradient(rgba(30, 136, 229, 0.85), rgba(21, 101, 192, 0.85)),
                url('https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQTdWB7tf_pnmxyXAbFW2FMP3QKjTKoDTMoKg&s') center/cover no-repeat;
            /* ✅ change path as needed */
            background-blend-mode: overlay;
            backdrop-filter: blur(2px);
        }


        .hero .logo {
            width: 80px;
            height: 180px;
            border-radius: 50%;
            background: white;
            color: var(--hero-blue);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 28px;
            font-weight: 700;
            margin-bottom: 25px;
        }

        .hero h1 {
            font-size: 80px;
            font-weight: 700;
            margin-bottom: 15px;
        }

        .hero p {
            font-size: 16px;
            max-width: 400px;
            line-height: 1.6;
            opacity: 0.9;
        }

        /* Form Container */
        .container {
            flex: 1;
            background: white;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 40px;
        }

        .form-box {
            width: 100%;
            max-width: 420px;
            background: #fff;
            border-radius: 12px;
            padding: 35px 30px 40px;
            box-shadow: 0 2px 12px rgba(0, 0, 0, 0.06);
        }

        .logo {
            text-align: center;
            margin-bottom: 20px;
        }

        .logo h1 {
            font-size: 28px;
            color: var(--primary);
            font-weight: 700;
        }

        .logo p {
            color: var(--secondary);
            font-size: 13px;
            margin-top: 4px;
        }

        .switch-buttons {
            display: flex;
            justify-content: center;
            margin-bottom: 25px;
            border: 1px solid var(--border);
            border-radius: 8px;
            overflow: hidden;
        }

        .switch-buttons button {
            flex: 1;
            padding: 10px 0;
            font-size: 14px;
            font-weight: 600;
            background: white;
            border: none;
            color: var(--secondary);
            cursor: pointer;
        }

        .switch-buttons button.active {
            background: var(--primary);
            color: white;
        }

        .form-group {
            margin-bottom: 15px;
        }

        label {
            display: block;
            color: var(--primary);
            font-size: 13px;
            margin-bottom: 6px;
        }

        input {
            width: 100%;
            padding: 11px 14px;
            border: 1px solid var(--border);
            border-radius: 8px;
            font-size: 14px;
            background: white;
        }

        input:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(45, 45, 45, 0.05);
        }

        .button {
            width: 100%;
            padding: 12px;
            background: var(--primary);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
            margin-top: 8px;
        }

        .button:hover:enabled {
            background: var(--accent);
            transform: translateY(-1px);
        }

        .button:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }

        .divider {
            display: flex;
            align-items: center;
            margin: 20px 0;
            color: var(--secondary);
            font-size: 12px;
        }

        .divider::before,
        .divider::after {
            content: '';
            flex: 1;
            height: 1px;
            background: var(--border);
        }

        .divider span {
            margin: 0 12px;
        }

        #googleButton {
            display: flex;
            justify-content: center;
            margin-top: 10px;
        }

        .loading {
            display: none;
            font-size: 12px;
            color: var(--secondary);
            margin-top: 6px;
            text-align: center;
        }

        .error {
            color: #dc3545;
            font-size: 12px;
            margin-top: 5px;
            display: none;
        }

        .success {
            color: #28a745;
            font-size: 12px;
            margin-top: 5px;
            display: none;
        }

        .footer-text {
            text-align: center;
            color: var(--secondary);
            font-size: 12px;
            margin-top: 20px;
        }

        .hidden {
            display: none;
        }

        .otp-timer {
            font-size: 13px;
            color: var(--secondary);
            text-align: center;
            margin-top: 8px;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .wrapper {
                flex-direction: column;
            }

            .hero {
                padding: 40px 20px;
                text-align: center;
                align-items: center;
            }

            .hero .logo {
                width: 90px;
                height: 90px;
                font-size: 32px;
                margin-bottom: 15px;
            }

            .hero h1 {
                font-size: 34px;
                margin-bottom: 8px;
            }

            .hero p {
                display: none;
            }

            .container {
                padding: 20px;
            }

            .form-box {
                box-shadow: none;
                padding: 25px 20px;
            }
        }
    </style>
</head>

<body>
    <div class="wrapper">
        <div class="hero">

            <h1>PageoNix</h1>
            <p>Empowering startups and creators with modern web solutions, automation tools, and integrations — built
                with precision and creativity.</p>
        </div>

        <div class="container">
            <div class="form-box" id="mainContainer">
                <div class="logo">
                    <h1>PageoNix</h1>
                    <p>Professional Web Solutions</p>
                </div>

                <div class="switch-buttons" id="switchContainer">
                    <button id="signupBtn" class="active" onclick="switchForm('signup')">Sign Up</button>
                    <button id="loginBtn" onclick="switchForm('login')">Login</button>
                </div>

                <div id="formArea">
                    <!-- Signup Form -->
                    <div id="signupForm">
                        <div id="emailForm">
                            <div class="form-group">
                                <label>Full Name</label>
                                <input type="text" id="nameInput" placeholder="John Doe" required>
                                <div class="error" id="nameError"></div>
                            </div>
                            <div class="form-group">
                                <label>Email Address</label>
                                <input type="email" id="emailInput" placeholder="you@example.com" required>
                                <div class="error" id="emailError"></div>
                            </div>
                            <button class="button" id="sendOtpBtn" onclick="sendOTP()">Send OTP</button>
                            <div class="loading" id="otpLoading">Sending OTP...</div>
                        </div>

                        <div id="otpForm" class="hidden">
                            <p style="font-size:13px;color:var(--secondary);">OTP sent to <span id="otpEmail"></span>
                            </p>
                            <div class="form-group">
                                <label>Enter OTP</label>
                                <input type="text" id="otpInput" placeholder="6-digit code" maxlength="6">
                                <div class="error" id="otpError"></div>
                                <div class="success" id="otpSuccess"></div>
                            </div>
                            <div class="otp-timer" id="otpTimer"></div>
                            <button class="button" id="verifyOtpBtn" onclick="verifyOTP()">Verify OTP</button>
                            <button class="button" style="background:#444;margin-top:6px;" onclick="resendOTP()">Resend
                                OTP</button>
                            <button class="button" style="background:#888;margin-top:6px;"
                                onclick="switchToEmail()">Resubmit Email</button>
                        </div>
                    </div>

                    <!-- Login Form -->
                    <div id="loginForm" class="hidden">
                        <div id="loginEmailSection">
                            <div class="form-group">
                                <label>Email Address</label>
                                <input type="email" id="loginEmail" placeholder="you@example.com" required>
                                <div class="error" id="loginEmailError"></div>
                            </div>
                            <button class="button" id="loginOtpBtn" onclick="sendLoginOTP()">Send OTP</button>
                            <div class="loading" id="loginOtpLoading">Sending OTP...</div>
                        </div>

                        <div id="loginOtpSection" class="hidden">
                            <p style="font-size:13px;color:var(--secondary);">OTP sent to <span
                                    id="loginOtpEmail"></span></p>
                            <div class="form-group">
                                <label>Enter OTP</label>
                                <input type="text" id="loginOtpInput" placeholder="6-digit code" maxlength="6">
                                <div class="error" id="loginOtpError"></div>
                                <div class="success" id="loginOtpSuccess"></div>
                            </div>
                            <div class="otp-timer" id="loginOtpTimer"></div>
                            <button class="button" id="loginVerifyOtpBtn" onclick="verifyLoginOTP()">Verify OTP</button>
                            <button class="button" style="background:#444;margin-top:6px;"
                                onclick="resendLoginOTP()">Resend OTP</button>
                            <button class="button" style="background:#888;margin-top:6px;"
                                onclick="switchLoginEmail()">Resubmit Email</button>
                        </div>
                    </div>

                    <div class="divider" id="divider"><span>or</span></div>
                    <div id="googleButton">Loading Google Sign-In...</div>
                    <div class="loading" id="googleProcessing">Processing Google login...</div>
                    <div class="error" id="googleError"></div>
                    <div class="footer-text" id="footerText">By continuing, you agree to our <a
                            href="https://pageonix.github.io/home/pages/terms.html" target="_blank"
                            rel="noopener noreferrer">terms</a> and <a
                            href="https://pageonix.github.io/home/pages/terms.html" target="_blank"
                            rel="noopener noreferrer">privacy policy</a>.
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>

        const BASE_URL = "https://app.pageonix.in";

        window.api = function(endpoint, options = {}) {
        const full = endpoint.startsWith("http")
            ? endpoint
            : BASE_URL + endpoint;

        return fetch(full, options);
        };


        const GOOGLE_CLIENT_ID = "590908379289-glhds4mjehpv6pditg66a0r11o5nmrd6.apps.googleusercontent.com";

        function initGoogleAuth() {
            google.accounts.id.initialize({
                client_id: GOOGLE_CLIENT_ID,
                callback: handleGoogleLogin
            });
            google.accounts.id.renderButton(
                document.getElementById('googleButton'),
                { theme: 'outline', size: 'large', shape: 'rectangular', text: 'signin_with', width: 260 }
            );
        }
        window.onload = initGoogleAuth;

        function handleGoogleLogin(response) {
            toggleLoading(true, 'googleProcessing');
            fetch('https://app.pageonix.in/api/auth/google', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ token: response.credential })
            })
                .then(r => r.json())
                .then(data => {
                    toggleLoading(false, 'googleProcessing');
                    if (data.status === 'success') window.location.href = 'https://pageonix.in/home/pages/forms/submit.html';
                    else showError('googleError', data.message);
                })
                .catch(() => {
                    toggleLoading(false, 'googleProcessing');
                    showError('googleError', 'Google authentication failed.');
                });
        }

        function switchForm(type) {
            document.getElementById("signupBtn").classList.toggle("active", type === "signup");
            document.getElementById("loginBtn").classList.toggle("active", type === "login");
            document.getElementById("signupForm").classList.toggle("hidden", type === "login");
            document.getElementById("loginForm").classList.toggle("hidden", type === "signup");
            clearErrors();
        }

        function toggleLoading(state, id, btnId) {
            const loading = document.getElementById(id);
            const button = btnId ? document.getElementById(btnId) : null;
            loading.style.display = state ? 'block' : 'none';
            if (button) button.disabled = state;
        }

        function validateEmail(email) {
            return /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email);
        }

        /* ---------- SIGNUP FLOW ---------- */
        function sendOTP() {
            clearErrors();
            const name = document.getElementById('nameInput').value.trim();
            const email = document.getElementById('emailInput').value.trim();
            if (!name) return showError('nameError', 'Name is required');
            if (!validateEmail(email)) return showError('emailError', 'Invalid email format');

            toggleLoading(true, 'otpLoading', 'sendOtpBtn');

            fetch('https://app.pageonix.in/api/auth/send-otp', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ name, email })
            })
                .then(r => r.json())
                .then(data => {
                    toggleLoading(false, 'otpLoading', 'sendOtpBtn');
                    if (data.status === 'success') {
                        prepareOTPStage('signup', email);
                        startOTPTimer('otpTimer');
                    } else showError('emailError', data.message);
                })
                .catch(() => showError('emailError', 'Failed to send OTP'));
        }

        function prepareOTPStage(mode, email) {
            document.getElementById('switchContainer').classList.add('hidden');
            document.getElementById('divider').classList.add('hidden');
            document.getElementById('googleButton').classList.add('hidden');
            document.getElementById('footerText').classList.add('hidden');

            if (mode === 'signup') {
                document.getElementById('emailForm').classList.add('hidden');
                document.getElementById('otpForm').classList.remove('hidden');
                document.getElementById('otpEmail').textContent = email;
            } else {
                document.getElementById('loginEmailSection').classList.add('hidden');
                document.getElementById('loginOtpSection').classList.remove('hidden');
                document.getElementById('loginOtpEmail').textContent = email;
            }
        }

        function verifyOTP() {
            const email = document.getElementById('emailInput').value.trim();
            const otp = document.getElementById('otpInput').value.trim();
            if (otp.length !== 6) return showError('otpError', 'Enter 6-digit code');
            fetch('https://app.pageonix.in/api/auth/verify-otp', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ email, otp })
            })
                .then(r => r.json())
                .then(data => {
                    if (data.status === 'success') {
                        showSuccess('otpSuccess', 'Verified! Redirecting...');
                        setTimeout(() => window.location.href = 'https://pageonix.in/home/pages/forms/submit.html', 1000);
                    } else showError('otpError', data.message);
                });
        }

        /* ---------- LOGIN FLOW ---------- */
        function sendLoginOTP() {
            clearErrors();
            const email = document.getElementById('loginEmail').value.trim();
            if (!validateEmail(email)) return showError('loginEmailError', 'Invalid email');
            toggleLoading(true, 'loginOtpLoading', 'loginOtpBtn');

            fetch('https://app.pageonix.in/api/auth/send-otp', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ name: "", email })
            })
                .then(r => r.json())
                .then(data => {
                    toggleLoading(false, 'loginOtpLoading', 'loginOtpBtn');
                    if (data.status === 'success') {
                        prepareOTPStage('login', email);
                        startOTPTimer('loginOtpTimer');
                    } else showError('loginEmailError', data.message);
                });
        }

        function verifyLoginOTP() {
            const email = document.getElementById('loginEmail').value.trim();
            const otp = document.getElementById('loginOtpInput').value.trim();
            if (otp.length !== 6) return showError('loginOtpError', 'Enter 6-digit code');
            fetch('https://app.pageonix.in/api/auth/verify-otp', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ email, otp })
            })
                .then(r => r.json())
                .then(data => {
                    if (data.status === 'success') {
                        showSuccess('loginOtpSuccess', 'Verified! Redirecting...');
                        setTimeout(() => window.location.href = 'https://pageonix.in/home/pages/forms/submit.html', 1000);
                    } else showError('loginOtpError', data.message);
                });
        }

        /* ---------- UTILITIES ---------- */
        function switchToEmail() {
            document.getElementById('otpForm').classList.add('hidden');
            document.getElementById('emailForm').classList.remove('hidden');
            restoreDefaultUI();
        }
        function switchLoginEmail() {
            document.getElementById('loginOtpSection').classList.add('hidden');
            document.getElementById('loginEmailSection').classList.remove('hidden');
            restoreDefaultUI();
        }

        function restoreDefaultUI() {
            ['switchContainer', 'divider', 'googleButton', 'footerText'].forEach(id => document.getElementById(id).classList.remove('hidden'));
        }

        function startOTPTimer(id) {
            const timerEl = document.getElementById(id);
            let remaining = 600;
            const updateTimer = () => {
                const min = Math.floor(remaining / 60);
                const sec = remaining % 60;
                timerEl.textContent = `OTP expires in ${min}:${sec.toString().padStart(2, '0')}`;
                if (remaining <= 0) timerEl.textContent = "OTP expired. Please resend.";
                else remaining--;
            };
            updateTimer();
            const interval = setInterval(() => {
                updateTimer();
                if (remaining <= 0) clearInterval(interval);
            }, 1000);
        }

        function showError(id, msg) { const el = document.getElementById(id); if (el) { el.textContent = msg; el.style.display = 'block'; el.style.color = '#dc3545'; } }
        function showSuccess(id, msg) { const el = document.getElementById(id); if (el) { el.textContent = msg; el.style.display = 'block'; el.style.color = '#28a745'; } }
        function clearErrors() { document.querySelectorAll('.error, .success').forEach(e => e.style.display = 'none'); }


        (function () {

            // Prevent bot / crawler spam
            const ua = navigator.userAgent.toLowerCase();
            if (ua.includes("bot") || ua.includes("crawl") || ua.includes("spider")) {
                return; // do not track bots
            }

            function getQuerySource() {
                const params = new URLSearchParams(window.location.search);

                return (
                    params.get("source") ||
                    params.get("ref") ||
                    params.get("utm") ||
                    params.get("from") ||
                    "direct"
                );
            }

            function sendTrack() {
                const payload = {
                    page_name: document.title?.trim() || window.location.pathname,
                    source: getQuerySource()
                };

                fetch("https://app.pageonix.in/api/xtrack-register-visit", {
                    method: "POST",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify(payload)
                }).catch(err => console.warn("Track failed:", err));
            }

            // Ensure DOM ready (safest)
            if (document.readyState === "complete" || document.readyState === "interactive") {
                sendTrack();
            } else {
                document.addEventListener("DOMContentLoaded", sendTrack);
            }

        })();


    </script>
</body>

</html>